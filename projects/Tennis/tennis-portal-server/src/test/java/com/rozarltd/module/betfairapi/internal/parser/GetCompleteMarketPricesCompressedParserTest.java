package com.rozarltd.module.betfairapi.internal.parser;

import com.rozarltd.module.betfairapi.domain.market.BetfairMarketPrices;
import org.junit.Test;

import static org.hamcrest.Matchers.is;
import static org.junit.Assert.assertThat;

public class GetCompleteMarketPricesCompressedParserTest {
    private static final String VALID_COMPRESSED_DATA = "104860140~5~:2251579~0~589869.16~1.14~~~false~0~~~~|1.01~44375.05~0.0~0.0~0.0~1.02~37699.38~0.0~0.0~0.0~1.03~29111.22~0.0~0.0~0.0~1.04~26021.96~0.0~0.0~0.0~1.05~23591.59~0.0~0.0~0.0~1.06~21418.3~0.0~0.0~0.0~1.07~22052.35~0.0~0.0~0.0~1.08~20983.87~0.0~0.0~0.0~1.09~20150.61~0.0~0.0~0.0~1.1~20235.54~0.0~0.0~0.0~1.11~20769.11~0.0~0.0~0.0~1.12~19894.84~0.0~0.0~0.0~1.13~27950.55~0.0~0.0~0.0~1.14~0.0~9932.86~0.0~0.0~1.15~0.0~20535.66~0.0~0.0~1.16~0.0~21608.2~0.0~0.0~1.17~0.0~8587.69~0.0~0.0~1.18~0.0~11247.59~0.0~0.0~1.2~0.0~8586.01~0.0~0.0~1.21~0.0~8586.01~0.0~0.0~1.22~0.0~83.71~0.0~0.0~1.3~0.0~116.49~0.0~0.0~1.31~0.0~237.06~0.0~0.0~1.32~0.0~190.35~0.0~0.0~1.34~0.0~33.0~0.0~0.0~1.35~0.0~847.98~0.0~0.0~1.36~0.0~115.0~0.0~0.0~1.4~0.0~62.28~0.0~0.0~1.41~0.0~6.34~0.0~0.0~1.43~0.0~2927.17~0.0~0.0~1.45~0.0~2.53~0.0~0.0~1.46~0.0~2.0~0.0~0.0~1.49~0.0~20.0~0.0~0.0~1.5~0.0~72.52~0.0~0.0~1.53~0.0~3.91~0.0~0.0~1.54~0.0~6.34~0.0~0.0~1.56~0.0~36.72~0.0~0.0~1.57~0.0~2.51~0.0~0.0~1.64~0.0~837.17~0.0~0.0~1.69~0.0~120.0~0.0~0.0~1.75~0.0~67.74~0.0~0.0~1.92~0.0~27.68~0.0~0.0~1.98~0.0~4.18~0.0~0.0~2.0~0.0~61.01~0.0~0.0~2.2~0.0~9.2~0.0~0.0~3.3~0.0~5.02~0.0~0.0~5.0~0.0~4.18~0.0~0.0~1000.0~0.0~3.38~0.0~0.0~:2291860~1~16870.17~7.6~~~false~0~~~~|1.01~7078.01~0.0~0.0~0.0~1.02~5319.09~0.0~0.0~0.0~1.03~1534.8~0.0~0.0~0.0~1.04~431.13~0.0~0.0~0.0~1.05~2.64~0.0~0.0~0.0~1.07~563.16~0.0~0.0~0.0~1.1~25.0~0.0~0.0~0.0~1.15~63.45~0.0~0.0~0.0~1.2~95.06~0.0~0.0~0.0~1.22~1301.79~0.0~0.0~0.0~1.3~7.61~0.0~0.0~0.0~1.56~0.11~0.0~0.0~0.0~1.8~12.55~0.0~0.0~0.0~2.0~50.23~0.0~0.0~0.0~2.4~0.59~0.0~0.0~0.0~3.0~5.41~0.0~0.0~0.0~4.2~31.72~0.0~0.0~0.0~5.7~149.98~0.0~0.0~0.0~6.8~75.64~0.0~0.0~0.0~7.2~112.26~0.0~0.0~0.0~8.0~100.7~0.0~0.0~0.0~11.0~0.0~4.18~0.0~0.0~15.0~0.0~9.51~0.0~0.0~1000.0~0.0~3.38~0.0~0.0~";

    private GetCompleteMarketPricesCompressedParser parser = new GetCompleteMarketPricesCompressedParser();

    @Test
    public void shouldParseCompressedDataAndConvertToBetfairMarketPricesObject() {
        // given
        String validCompressedData = VALID_COMPRESSED_DATA;

        // when
        BetfairMarketPrices betfairMarketPrices = parser.parse(validCompressedData);

        // then
        assertThat(betfairMarketPrices.getInPlayDelay(), is("5"));
    }
}
